<div class="tool-bar controls-row">
  <h5>Monthly Attendance</h5>
  <span class="spacer"></span>
  <div class="input-group">
    <span class="input-group-addon" id="basic-addon1">Month</span>
    <input id="monthSelector" type="text" class="form-control input-sm calendar no-spin">
  </div>
  <button md-icon-button (click)="isFilter = !isFilter" mdTooltip="Filters" class="marginLetf" [mdTooltipPosition]="'above'">
    <i class="fa fa-filter fa-lg" aria-hidden="true"></i>
  </button>

  <button [matMenuTriggerFor]="moreMenu" md-icon-button>
    <md-icon>more_vert</md-icon>
  </button>
  <md-menu #moreMenu="mdMenu">
    <button md-menu-item (click)="regenerate()" [mdTooltipPosition]="'above'" mdTooltip="Regenerate">
      <md-icon>build</md-icon> Regenerate
    </button>
    <button md-menu-item [matMenuTriggerFor]="downloadMenu">
      <md-icon>cloud_download</md-icon> Download
    </button>
    <md-menu #downloadMenu="mdMenu">
      <button md-menu-item (click)="downloadlink()">Report</button>
    </md-menu>
  </md-menu>
</div>

<md-spinner class="custom_spinner" *ngIf="monthlyAttendnace?.isLoading" mode="indeterminate"></md-spinner>
<aqua-employees-filter *ngIf="isFilter" [fields]="filterFields" (onReset)="reset()" (onChange)="applyFilters($event)"></aqua-employees-filter>
<div class="row">
  <md-card class="card">
    <div class="table-responsive full">
      <table class="table table-condensed table-hover">
        <thead class="primary_thead">
          <tr>
            <th>Name</th>
            <th class="tdWidth">Designation</th>
            <th class="tdWidth">Shift</th>
            <th class="tdWidth">Present Days</th>
            <th class="tdWidth">Absent Days</th>
            <th class="tdWidth">Leave Balance</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of monthlyAttendnace.items | paginate: { id: 'foo',
                                                      itemsPerPage: monthlyAttendnace.pageSize,
                                                      currentPage: monthlyAttendnace.pageNo,
                                                      totalItems: monthlyAttendnace.totalRecords };"
            class="capitalize">
            <td>
              <div class="cols">
                <div>
                  <img *ngIf="item?.picUrl" class="img-circle img-profile" alt="img" [src]="item?.picUrl" onError="this.src='/assets/images/blank.png'">
                  <img *ngIf="!item?.picUrl" class="img-circle img-profile" alt="img" src="assets/images/blank.png">
                </div>
                <div>
                  <a *ngIf="auth.hasPermission('superadmin')" [routerLink]="[ '/', 'employees', item?.code]">{{item?.name
                    || '--'}}</a>
                  <span *ngIf="!auth.hasPermission('superadmin')">{{item?.name || '--'}}</span>
                  <p class="sub-text">{{item?.code || ''}}</p>
                </div>
              </div>
            </td>
            <td class="tdWidth">{{item?.designation || '--'}}</td>
            <td class="tdWidth">{{item?.shiftType?.name || '--'}}</td>
            <td class="tdWidth">{{item?.presentDays || '--'}}</td>
            <td class="tdWidth">{{item?.absentDays || '--'}}</td>
            <td class="tdWidth">{{item?.totalLeaveBalance | number:'1.0-2'}}</td>
            <td><button class="subtle" md-icon-button [routerLink]="[item.id]"><i class="fa fa-chevron-right"></i></button></td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="mini">
      <aqua-monthly-mobile-view [monthlyAttendance]="monthlyAttendnace.items"></aqua-monthly-mobile-view>
    </div>
    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
      <div class="custom_pagination">
        <pagination-controls id="foo" (pageChange)="monthlyAttendnace.pageNo = $event;getAttendance();"></pagination-controls>
        <label class="full">Total Records: {{monthlyAttendnace.totalRecords}}</label>
        <div class="pageSize">
          <label>Page Size:</label>
          <select name="pageSize" [(ngModel)]="monthlyAttendnace.pageSize" (change)="monthlyAttendnace.pageNo = 1;getAttendance();">
            <option value=10>10</option>
            <option value=50>50</option>
            <option value=100>100</option>
            <option value=500>500</option>
          </select>
        </div>
      </div>
    </div>
  </md-card>
</div>
